Code Red Attack 2001 

Impact
 defaced webpage of victim host (if in US)
 1-2 million victim hosts
 DoS attack on whitehouse.gov after midnight July 19th
 attack used IP address of whitehouse.gov
 FBI and others believe it originated from China (U. of Foshan) 
 most harmful: network traffic when searching for more hosts to infect
 variants of Code Red appeared later


Attacked hosts running IIS = Internet Information Services
 MS’s webserver
 IIS v. 4.0 or 5.0

Propagation
 buffer overflow vulnerability in MS IIS

“Worm” behavior
  when a computer was infected,
  the worm started searching for other possible victims
  the program would then infect the other victims,
  by copying itself to them
  so needed no other software/files to propagate, 
  such as when propagation is due to
  users share infected MS Word documents

Stallings & Brown, p365:
 “Microsoft programmers have also undertaken a major project in reviewing 
 their codebose, partly in response to continuing bad publicity over the 
 number of vulnerabilities, including many buffer overflow issues”.

On many Windows variants, the IIS Webserver was installed by default
 also on ordinary PCs/workstations
 IIS executed with admin (root) privileges
 Code Red inherited those privileges
 root privileges not necessary for a web server
 (though Code Red would possibly be damiging even with normal privileges)

A program must reject attempts to 
write more data to a buffer (an array) 
than the capacity allocated.
 Rejection may be by array bounds 
checking, as in Java or C#  

0 day vulnerability: when attacker is aware of vulnerability on day 0, before MS aware or before MS patch.

Vulnerability life cycle
 0. Software developed and distributed with vulnerability
 1. Vulnerability found.
 2. Vulnerability reported to MS
 3. MS develops patch while maintaining secrecy
 4. MS publishes patch
 5. Users use the patch (hopefully)
